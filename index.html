<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Sand Grain Analysis System</title>
    <style>
        /* ... (Your original CSS is here - no change needed) ... */
        * {
            margin: 0;
            padding: 0;
            box-sizing: border-box;
        }

        body {
            font-family: 'Segoe UI', Tahoma, Geneva, Verdana, sans-serif;
            line-height: 1.6;
            color: #333;
            scroll-behavior: smooth;
        }

        /* Navigation */
        nav {
            position: fixed;
            top: 0;
            width: 100%;
            background: rgba(255, 255, 255, 0.05);
            backdrop-filter: blur(10px);
            z-index: 1000;
            padding: 1rem 0;
            box-shadow: 0 2px 20px rgba(0,0,0,0.1);
        }

        .nav-container {
            max-width: 1200px;
            margin: 0 auto;
            padding: 0 2rem;
            display: flex;
            justify-content: space-between;
            align-items: center;
        }

        .logo {
            font-size: 1.8rem;
            font-weight: bold;
            color: #000000;
        }

        .nav-links {
            display: flex;
            list-style: none;
            gap: 2rem;
            font-size: 1.2rem;
        }

        .nav-links a {
            text-decoration: none;
            color: #000000;
            font-weight: 500;
            transition: color 0.3s;
        }

        .nav-links a:hover {
            color: #04ff8a;
        }

        /* Sections */
        section {
            min-height: 100vh;
            padding: 5rem 2rem;
            max-width: 1530px;
            margin: 0 auto;
            display: flex;
            align-items: center;
            justify-content: center;
            flex-direction: column;
             background: rgb(250, 247, 247);
        }
.mentor-{
    min-height: 200px;
}
/* Hero Section */
.hero {
    /* REMOVE the old linear-gradient background */
    
    /* ADD these background image properties */
    background: url('beach.jpg') no-repeat center center;
    background-size: cover;
    z-index: 1;
    
    /* Keep existing color and padding */
    color: rgb(255, 255, 255);
    text-align: center;
    margin: 0;
    max-width: 100%;
    padding-top: 10rem; /* Ensure text is visible over the image */
}

        .hero h1 {
            font-size: 3.5rem;
            margin-bottom: 1rem;
            opacity: 0;
            animation: fadeInUp 1s ease forwards;
        }

        .hero p {
            font-size: 1.2rem;
            margin-bottom: 3rem;
            opacity: 0;
            animation: fadeInUp 1s ease 0.3s forwards;
        }


        .main-buttons {
            display: flex;
            gap: 1rem;
            flex-wrap: wrap;
            justify-content: center;
            opacity: 0;
            animation: fadeInUp 1s ease 0.6s forwards;
            margin-bottom: 3rem;
        }

        .gallery-preview {
            max-width: 800px;
            margin: 0 auto;
            opacity: 0;
            animation: fadeInUp 1s ease 0.9s forwards;
        }

        .gallery-preview h3 {
            text-align: center;
            margin-bottom: 2rem;
        }

        .btn {
            padding: 1rem 2rem;
            border: none;
            border-radius: 50px;
            font-size: 1rem;
            font-weight: 600;
            cursor: pointer;
            transition: all 0.3s ease;
            text-decoration: none;
            display: inline-block;
        }

        .btn-primary {
            background: white;
            color: #667eea;
        }

        .btn-primary:hover {
            transform: translateY(-2px);
            box-shadow: 0 8px 25px rgba(0,0,0,0.2);
        }

        .btn-secondary {
            background: transparent;
            color: white;
            border: 2px solid white;
        }

        .btn-secondary:hover {
            background: white;
            color: #667eea;
        }

        /* Content Sections */
        .content-section {
            padding: 4rem 2rem;
        }

        .content-section h2 {
            font-size: 2.5rem;
            margin-bottom: 2rem;
            text-align: center;
            color: #333;
        }

        .features-grid {
            display: grid;
            grid-template-columns: repeat(auto-fit, minmax(300px, 1fr));
            gap: 2rem;
            margin: 3rem 0;
        }

        .feature-card {
            background: white;
            padding: 2rem;
            border-radius: 15px;
            box-shadow: 0 5px 15px rgba(0,0,0,0.1);
            text-align: center;
            transition: transform 0.3s ease;
        }

        .feature-card:hover {
            transform: translateY(-5px);
        }

        .feature-icon {
            font-size: 3rem;
            margin-bottom: 1rem;
        }

        .feature-card h3 {
            margin-bottom: 1rem;
            color: #667eea;
        }

        /* Map Section */
        .map-section {
            background: #f8f9fa;
        }

        #map {
            align-items: center;
            width: 100%;
            height: 400px;
            border-radius: 15px;
            margin: 2rem 0;
            box-shadow: 0 5px 15px rgba(0,0,0,0.1);
        }

        /* Gallery Section */
        .gallery-grid {
            display: grid;
            grid-template-columns: repeat(auto-fit, minmax(200px, 1fr));
            gap: 1rem;
            margin: 2rem 0;
        }

        .gallery-item {
            background: rgba(255, 255, 255, 0.9);
            border-radius: 10px;
            padding: 2rem;
            text-align: center;
            border: 2px dashed #ddd;
            transition: all 0.3s ease;
        }

        .gallery-item:hover {
            border-color: #667eea;
            background: rgba(255, 255, 255, 1);
        }

        /* Analysis Grid */
        .analysis-grid {
            display: grid;
            grid-template-columns: repeat(auto-fit, minmax(350px, 1fr));
            gap: 2rem;
            margin: 3rem 0;
        }

        .analysis-item {
            background: white;
            border-radius: 15px;
            padding: 1.5rem;
            box-shadow: 0 5px 15px rgba(0,0,0,0.1);
            display: flex;
            gap: 1.5rem;
            align-items: flex-start;
        }

        .analysis-image {
            flex: 0 0 150px;
        }

        .analysis-image img {
            width: 100%;
            height: 150px;
            object-fit: cover;
            border-radius: 10px;
        }

        .analysis-data {
            flex: 1;
        }

        .analysis-data h4 {
            margin: 0 0 1rem 0;
            color: #333;
            font-size: 1.1rem;
        }

        .data-row {
            display: flex;
            justify-content: space-between;
            margin-bottom: 0.5rem;
            padding: 0.25rem 0;
            border-bottom: 1px solid #eee;
        }

        .data-label {
            font-weight: 600;
            color: #555;
        }

        .data-value {
            color: #333;
        }

        .analysis-placeholder {
            grid-column: 1 / -1;
            text-align: center;
            padding: 3rem;
            background: #f8f9fa;
            border-radius: 15px;
            border: 2px dashed #ddd;
        }

        /* Analysis Section */
        .analysis-stats {
            display: grid;
            grid-template-columns: repeat(auto-fit, minmax(200px, 1fr));
            gap: 2rem;
            margin: 3rem 0;
        }

        .stat-card {
            background: linear-gradient(135deg, #667eea, #764ba2);
            color: white;
            padding: 2rem;
            border-radius: 15px;
            text-align: center;
        }

        .stat-number {
            font-size: 2.5rem;
            font-weight: bold;
            display: block;
        }

        /* About Section */
        .about-section {
            background: linear-gradient(135deg, #f8f9fa 0%, #e9ecef 100%);
        }

        .team-info {
            text-align: center;
            max-width: 800px;
        }

        /* Animations */
        @keyframes fadeInUp {
            from {
                opacity: 0;
                transform: translateY(30px);
            }
            to {
                opacity: 1;
                transform: translateY(0);
            }
        }

        /* Modal */
        .modal {
            display: none;
            position: fixed;
            z-index: 2000;
            left: 0;
            top: 0;
            width: 100%;
            height: 100%;
            background-color: rgba(0,0,0,0.5);
        }

        .modal-content {
            background-color: white;
            margin: 15% auto;
            padding: 2rem;
            border-radius: 15px;
            width: 90%;
            max-width: 500px;
            text-align: center;
        }

        .close-btn {
            color: #aaa;
            float: right;
            font-size: 28px;
            font-weight: bold;
            cursor: pointer;
        }

        .close-btn:hover {
            color: #000;
        }

        /* Mobile Responsive */
        @media (max-width: 768px) {
            .nav-links {
                display: none;
            }

            .hero h1 {
                font-size: 2.5rem;
            }

            .main-buttons {
                flex-direction: column;
                align-items: center;
            }

            .analysis-grid {
                grid-template-columns: 1fr;
            }

            .analysis-item {
                flex-direction: column;
                text-align: center;
            }

            .analysis-image {
                flex: none;
                width: 100%;
            }

            .features-grid,
            .analysis-stats {
                grid-template-columns: 1fr;
            }

            section {
                padding: 3rem 1rem;
            }
        }

        /* Horizontal Image Scroller */
        .sample-images-container {
            margin: 2rem 0;
            background: #f8f9fa;
            border-radius: 15px;
            padding: 2rem;
            border: 1px solid #e9ecef;
        }

        .sample-images-title {
            font-size: 1.2rem;
            font-weight: 600;
            color: #333;
            margin-bottom: 1rem;
            text-align: center;
        }

        .horizontal-scroller {
            display: flex;
            overflow-x: auto;
            scroll-behavior: smooth;
            gap: 1rem;
            padding: 1rem 0;
            scrollbar-width: thin;
            scrollbar-color: #667eea #f1f1f1;
        }

        /* .horizontal-scroller::-webkit-scrollbar {
            height: 8px;
        }

        .horizontal-scroller::-webkit-scrollbar-track {
            background: #f1f1f1;
            border-radius: 10px;
        }

        .horizontal-scroller::-webkit-scrollbar-thumb {
            background: #667eea;
            border-radius: 10px;
        }

        .horizontal-scroller::-webkit-scrollbar-thumb:hover {
            background: #5a6fd8;
        } */

      .sample-image-item {
    flex: 0 0 auto;
    width: 320px;          /* medium width */
    height: 520px;         /* medium height */
    position: relative;
    border-radius: 10px;
    overflow: hidden;
    cursor: pointer;
    transition: transform 0.3s ease, box-shadow 0.3s ease;
    background: #fff;
    border: 2px solid #e9ecef;
}

.sample-image-item:hover {
    transform: translateY(-5px);
    box-shadow: 0 8px 25px rgba(0,0,0,0.15);
}

.sample-image-item img {
    width: 100%;
    height: 70%;
    object-fit: cover;
}

.sample-image-info {
    padding: 0.5rem;
    text-align: center;
    height: 30%;
    display: flex;
    flex-direction: column;
    justify-content: center;
}

.sample-image-info h4 {
    font-size: 1.05rem;    /* slightly bigger */
    color: #333;
    margin-bottom: 0.2rem;
}

.sample-image-info p {
    font-size: 0.9rem;
    color: #666;
}


        /* --- CSS for Fixed Video on Scroll --- */

#fixedVideoContainer {
    max-width: 800px;
    width: 100%;
    margin: 2rem auto;
    position: relative;
    padding-bottom: 30.25%; 
    height: 0;
    overflow: hidden;
    border-radius: 10px;
    box-shadow: 0 4px 15px rgba(0, 0, 0, 0.2);
}

#fixedVideoContainer video {
    position: absolute;
    top: 0;
    left: 0;
    width: 100%;
    height: 100%;
}
/* Ensure this is in your CSS for the layout */
/* --- Team Grid and Base Member Styles (Ensure these are present/updated) --- */
/* --- SIMPLIFIED TEAM CSS --- */








/* --- Role Specifics (Simple color accents) --- */

/* Mentors (role-mentor) */
.role-mentor {
    border-bottom: 3px solid #764ba2; /* Accent color on bottom */
    background: #f7f7ff;
}

.role-mentor .member-role {
    color: #764ba2;
}

/* Developers (role-dev) */
.role-dev {
    border-bottom: 3px solid #667eea; /* Accent color on bottom */
}

.role-dev .member-role {
    color: #667eea;
}
/* Mentor grid (only 2 columns, centered) */
/* Mentor grid (only 2 columns, centered) */
.team-grid-mentors {
    display: grid;
    grid-template-columns: repeat(auto-fit, minmax(180px, 220px));
    justify-content: center;
    gap: 1.5rem;
    margin: 1rem 0 2rem 0; /* üëà adds bottom margin */
}


    </style>
</head>
<body>
    <nav>
        <div class="nav-container">
            <div class="logo"> Varahamihira</div>
            <ul class="nav-links">
                <li><a href="#home">Home</a></li>
                <li><a href="#map">Map</a></li>
                <li><a href="#analysis">Validation & Analysis</a></li>
                <!-- <li><a href="#about">Our mentors</a></li> -->
            </ul>
        </div>
    </nav>

    <section id="home" class="hero">
        <h1>Sand Grain Analysis System</h1>
        <p>Advanced camera-based geological analysis for sand grain measurement and mapping</p>
        <h3 style="padding-bottom: 30px;">This is a prototype click buttons to know their functionality</h3>
        
        <div class="main-buttons">
            <button class="btn btn-primary" onclick="captureImage()">
                üì∑ Capture Image
            </button>
            <button class="btn btn-primary" onclick="uploadImage()">
                ‚¨ÜÔ∏è Upload Image
            </button>
            <button class="btn btn-primary" onclick="document.getElementById('analysis').scrollIntoView({ behavior: 'smooth' });">
            üé® Validation
            </button>

        </div>

        <div class="gallery-preview" id="galleryPreview">
            <h3 style="margin-bottom: 1rem; color: white;">Recent Captures</h3>
            <div class="gallery-grid" id="imageGallery">
                <div class="gallery-item">
                    <div style="font-size: 2rem; margin-bottom: 1rem; color: #667eea;">üì∑</div>
                    <p style="color: #333;">Your captured images will appear here</p>
                </div>
            </div>
        </div>
    </section>
<div style="display: flex; justify-content: center; align-items: center;">
    <h3>Please click <strong>Ok</strong> to see the mapping results.</h3>
</div>

  
<section id="map" class="content-section map-section">
    <h2 style="font-size: 2.5rem; margin-bottom: 2rem; text-align: center; color: #333;">üó∫Ô∏è Sample Locations Map</h2>
    <div id="map" style="width: 100%; height: 400px; border-radius: 15px; margin: 2rem 0; box-shadow: 0 5px 15px rgba(0,0,0,0.1);">
        </div>
</section>
    <section id="analysis" class="content-section">
        <div style="text-align: center; margin-bottom: 3rem;">
            <button class="btn btn-primary" onclick="showAnalysisInfo()" style="margin: 0.5rem;">üî¨ Analyze All</button>
        </div>

       
        <div style="text-align: center; margin-bottom: 3rem;">
                <h3>The sample below was taken from Mumbai Beach and processed through our system.</h3>
                <p>The results shown are obtained from our analysis. The next section presents validation performed in a civil lab under the guidance of an expert.</p>
        </div>
        <div class="analysis-item">
            <div class="analysis-image">
                <img src="input.jpeg" alt="Sample_1759072498753.jpg"> 
            </div>
    
            <div class="analysis-data">
                <h4>image analysis</h4>
        
                <div class="data-row">
                    <span class="data-label">Location:</span> 
                    <span class="data-value">19.112145, 72.822550</span>
                </div>
        
                <div class="data-row">
                    <span class="data-label">Average Size:</span> 
                    <span class="data-value">30.2px/0.433mm</span>
                </div>
        
                <div class="data-row">
                    <span class="data-label">standard deviation:</span> 
                    <span class="data-value">0.317mm</span>
                </div>
        
                <div class="data-row">
                    <span class="data-label">skewness:</span> 
                    <span class="data-value">positive(3.98)</span>
                </div>
        
                <div class="data-row">
                    <span class="data-label">Kurtosis:</span> 
                    <span class="data-value">positive(19.8)</span>
                </div>

                <div class="data-row">
                    <span class="data-label">Conclusion: Distribution of finer particles is more <br>than larger particles as skewness is positive </span> 
                    
                </div>
        
            </div>
        </div>
        <h2>üî¨ Validation & Analysis</h2>
        <p style="text-align: center; font-size: 1.1rem; margin-bottom: 3rem;">validation video </p>
       <div id="fixedVideoContainer" class="responsive-video-wrapper">
            <video 
                id="scrollVideo" 
                controls 
                poster="path/to/video-thumbnail.jpg"
                autoplay 
                muted
            >
                <source src="temp.mp4" type="video/mp4">
                Your browser does not support the video tag.
            </video>
        </div>

</div>
        <div class="sample-images-container">
            <h3 class="sample-images-title">validation of the above sample </h3>
            <div class="horizontal-scroller" id="sampleImagesScroller">
                <div class="sample-image-item">
                    <img src="valid2.jpeg">
                    <div class="sample-image-info">
                        <h4>sample of sand</h4>
                        <p>measuring sand weight.</p>
                    </div>
                </div>
                
                <div class="sample-image-item">
                    <img src="valid1.jpeg">
                    <div class="sample-image-info">
                        <h4>Bsampling sand</h4>
                        <p>Putting sand on the sieves for the sieving machine.</p>
                    </div>
                </div>
                
                <div class="sample-image-item">
                    <img src="valid3.jpeg">
                    <div class="sample-image-info">
                        <h4>sieving machine</h4>
                        <p>The sieves are set in the sieving machine, and the machine is turned on.</p>
                    </div>
                </div>
            </div>
            
        </div>
<div style="display: flex; justify-content: center; align-items: center;">
    <h3>Grain Size Analysis and Statistical Results</h3>
</div>
        
<img src="results1.jpeg">      


    </section>
<!-- <div id="about" class="mentor-">
    <div class="card">
    <h3 style="text-align: center; font-size: 2rem; margin-bottom: 3rem;">Our Mentors</h3>


    <div class="team-grid-mentors">
     
        <div class="team-member role-mentor">
            <h4>Assistant Professor</h4>
            <p class="member-role">School of E&TC Engineering</p>
            <p class="member-specialization">AI, ML, Biomedical Image & Signal Processing, Data Science</p>
        </div>


        <div class="team-member role-mentor">
            <h4>Lab Assistant</h4>
            <p class="member-role">Department of Civil Engineering</p>
            <p class="member-specialization">Civil Engineering Lab Support</p>
        </div>
    </div>   
</div>
</div> -->
<div style="text-align: center;
    margin-top: 2rem;
    font-size: 0.95rem;
    font-weight: 500;
    color: #555;
    padding-top: 0.75rem;
    padding-bottom: 0.75rem;
    border-top: 1px solid #eee;">
    Together, we build and innovate 
    </div>

    <div id="actionModal" class="modal">
        <div class="modal-content">
            <span class="close-btn" onclick="closeModal()">&times;</span>
            <h3 id="modalTitle">Action</h3>
            <p id="modalText">Processing your request...</p>
            <div id="modalActions"></div>
        </div>
    </div>

    <!-- <input type="file" accept="image/*" id="fileInput" style="display: none;" multiple>  -->

    <script async defer src="https://maps.googleapis.com/maps/api/js?key=&callback=initMap"></script>

    <script>
        // Global variables
   
        // const markerData = [
        //     {"name":"img1.jpg","lat":19.112397,"lng":72.822646,"area":24.98},
        //     {"name":"img2.jpg","lat":19.112429,"lng":72.822581,"area":48.03},
        //     {"name":"img3.jpg","lat":19.112407,"lng":72.822549,"area":39.28},
        //     {"name":"img4.jpg","lat":19.112409,"lng":72.822551,"area":33.95},
        //     {"name":"img5.jpg","lat":19.112452,"lng":72.822469,"area":16.24},
        //     {"name":"img6.jpg","lat":19.112397,"lng":72.822645,"area":16.24},
        //     {"name":"img7.jpg","lat":19.112388,"lng":72.822487,"area":12.32},
        //     {"name":"img8.jpg","lat":19.112397,"lng":72.822643,"area":49.77},
        //     {"name":"img9.jpg","lat":19.112318,"lng":72.822419,"area":27.09},
        //     {"name":"img10.jpg","lat":19.112185,"lng":72.822300,"area":44.5},
        //     {"name":"img11.jpg","lat":19.112301,"lng":72.822415,"area":27.84},
        //     {"name":"img12.jpg","lat":19.112409,"lng":72.822551,"area":45.03},
        //     {"name":"img13.jpg","lat":19.112378,"lng":72.822533,"area":36.19},
        //     {"name":"img14.jpg","lat":19.112397,"lng":72.822641,"area":10.61},
        //     {"name":"img15.jpg","lat":19.112397,"lng":72.822643,"area":35.26},
        //     {"name":"img16.jpg","lat":19.112453,"lng":72.822469,"area":11.85},
        //     {"name":"img17.jpg","lat":19.112388,"lng":72.822487,"area":23.71},
        //     {"name":"img18.jpg","lat":19.112409,"lng":72.822551,"area":46.59},
        //     {"name":"img19.jpg","lat":19.112397,"lng":72.822646,"area":39.22},
        //     {"name":"img20.jpg","lat":19.112397,"lng":72.822646,"area":37.56}
        // ];

        const markerData = [
    {"name":"img1.jpg","lat":19.112297,"lng":72.822496,"area":24.98, "zone": "Intertidal", "color": "#ef4444"}, // Red
    {"name":"img2.jpg","lat":19.112429,"lng":72.822451,"area":48.03, "zone": "Intertidal", "color": "#ef4444"},
    {"name":"img3.jpg","lat":19.112407,"lng":72.822449,"area":39.28, "zone": "Intertidal", "color": "#ef4444"},
    {"name":"img4.jpg","lat":19.112459,"lng":72.822441,"area":33.95, "zone": "Intertidal", "color": "#ef4444"},
    {"name":"img5.jpg","lat":19.112452,"lng":72.822369,"area":16.24, "zone": "Intertidal", "color": "#ef4444"},
    {"name":"img6.jpg","lat":19.112597,"lng":72.822450,"area":16.24, "zone": "Intertidal", "color": "#ef4444"},
    {"name":"img7.jpg","lat":19.112388,"lng":72.822430,"area":12.32, "zone": "Intertidal", "color": "#ef4444"},
    {"name":"img8.jpg","lat":19.112097,"lng":72.822559,"area":49.77, "zone": "Intertidal", "color": "#ef4444"},
    {"name":"img9.jpg","lat":19.112318,"lng":72.822419,"area":27.09, "zone": "Intertidal", "color": "#ef4444"},
    {"name":"img10.jpg","lat":19.112185,"lng":72.822450,"area":44.5, "zone": "Intertidal", "color": "#ef4444"},
    {"name":"img11.jpg","lat":19.112101,"lng":72.822755,"area":27.84, "zone": "Dune", "color": "#facc15"},     // Yellow
    {"name":"img12.jpg","lat":19.112409,"lng":72.822711,"area":45.03, "zone": "Dune", "color": "#facc15"},
    {"name":"img13.jpg","lat":19.112378,"lng":72.822443,"area":36.19, "zone": "Intertidal", "color": "#ef4444"},
    {"name":"img14.jpg","lat":19.112127,"lng":72.822450,"area":10.61, "zone": "Intertidal", "color": "#ef4444"},
    {"name":"img15.jpg","lat":19.112397,"lng":72.822529,"area":35.26, "zone": "Berm", "color": "#3b82f6"},      // Blue
    {"name":"img16.jpg","lat":19.112453,"lng":72.822569,"area":11.85, "zone": "Berm", "color": "#3b82f6"},
    {"name":"img17.jpg","lat":19.112388,"lng":72.822587,"area":23.71, "zone": "Berm", "color": "#3b82f6"},
    {"name":"img18.jpg","lat":19.112509,"lng":72.822421,"area":46.59, "zone": "Intertidal", "color": "#ef4444"},
    {"name":"img19.jpg","lat":19.112197,"lng":72.822636,"area":39.22, "zone": "Berm", "color": "#3b82f6"},
    {"name":"img20.jpg","lat":19.112497,"lng":72.822456,"area":37.56, "zone": "Intertidal", "color": "#ef4444"}
];
        // let capturedImages = JSON.parse(localStorage.getItem('capturedImages')) || [];
        let analysisResults = JSON.parse(localStorage.getItem('analysisResults')) || [];
        let map;
        let infoWindow;
        // Define the colors for clarity
const INTERTIDAL_COLOR = '#ef4444'; // Red
const BERM_COLOR = '#3b82f6';       // Blue
const DUNE_COLOR = '#facc15';        // Yellow

        // Initialize map
        // old 
    //     function initMap() {
    // map = new google.maps.Map(document.getElementById('map'), {
    //     center: { lat: 18.5204, lng: 73.8567 },
    //     zoom: 12,
    //     // MODIFIED LINE: 'cooperative' requires Ctrl/Cmd key (the default behavior)
    //     // Change to 'greedy' to allow zooming with simple mouse scroll (wheel)
    //     gestureHandling: 'greedy' 
    // });

    // // Add sample marker
    // new google.maps.Marker({
    //     position: { lat: 18.5204, lng: 73.8567 },
    //     map: map,
    //     title: 'Sample Location (Pune)',
    //     icon: {
    //         url: 'data:image/svg+xml;charset=UTF-8,' + encodeURIComponent(`
    //             <svg width="30" height="30" xmlns="http://www.w3.org/2000/svg">
    //                 <circle cx="15" cy="15" r="12" fill="#667eea" stroke="#fff" stroke-width="2"/>
    //                 <text x="15" y="19" font-family="Arial" font-size="16" fill="white" text-anchor="middle">üìç</text>
    //             </svg>
    //         `),
    //         scaledSize: new google.maps.Size(30, 30)
    //     }
    // });

    // updateStats();
// }
// new 
function initMap() {
    // Calculate the center of the markers
    const centerLat = markerData.reduce((sum, marker) => sum + marker.lat, 0) / markerData.length;
    const centerLng = markerData.reduce((sum, marker) => sum + marker.lng, 0) / markerData.length;

    const mapOptions = {
        center: { lat: centerLat, lng: centerLng },
        zoom: 18, 
        gestureHandling: 'greedy'
    };
    
    // Target the inner map div
    map = new google.maps.Map(document.getElementById('map'), mapOptions);
    infoWindow = new google.maps.InfoWindow();

    // Loop through the data to create markers
    markerData.forEach(markerInfo => {
        // Use the color directly from markerInfo!
        const markerColor = markerInfo.color; 
        
        const marker = new google.maps.Marker({
            position: { lat: markerInfo.lat, lng: markerInfo.lng },
            map: map,
            title: markerInfo.name,
            icon: {
                // **CHANGE: Use markerColor variable**
                url: 'data:image/svg+xml;charset=UTF-8,' + encodeURIComponent(`
                    <svg width="30" height="30" xmlns="http://www.w3.org/2000/svg">
                        <circle cx="15" cy="15" r="10" fill="${markerColor}" stroke="#fff" stroke-width="2"/>
                        <text x="15" y="20" font-family="Arial" font-size="12" fill="white" text-anchor="middle">S</text>
                    </svg>
                `),
                scaledSize: new google.maps.Size(30, 30)
            }
        });

        // Add a click listener to the marker
        marker.addListener('click', () => {
            
            // Prepends 'samples/' to the image name
            const imagePath = 'samples/' + markerInfo.name; 

            // **CHANGE: Only include the image in the contentString**
            const contentString = `
    <div style="text-align: center; padding: 5px;">
        <img src="${imagePath}" alt="${markerInfo.name}" 
              style="width: 150px; height: 100px; object-fit: cover; border-radius: 5px; margin-bottom: 5px;">
        <p style="margin: 0; font-size: 0.8em; color: black;">Lat:${markerInfo.lat} Lng:${markerInfo.lng}</p>
        <p style="margin: 0; font-size: 0.8em; color: black;">zone:${markerInfo.zone}</p>
    </div>
`;
            
            infoWindow.setContent(contentString);
            infoWindow.open(map, marker);
        });
    });
}
        

        // Select sample image function
        // function selectSampleImage(sampleId) {
        //     const sampleData = sampleImageData[sampleId];
        //     if (!sampleData) return;

        //     // Clear existing analysis
        //     const analysisGrid = document.getElementById('analysisGrid');
            
        //     // Create analysis display
        //     const analysisItem = document.createElement('div');
        //     analysisItem.className = 'analysis-item';
        //     analysisItem.innerHTML = `
        //         <div class="analysis-image">
        //             <img src="${document.querySelector(`[onclick="selectSampleImage('${sampleId}')"] img`).src}" alt="${sampleData.name}">
        //         </div>
        //         <div class="analysis-data">
        //             <h4>${sampleData.name}</h4>
        //             <div class="data-row"><span class="data-label">Location:</span> <span class="data-value">${sampleData.location}</span></div>
        //             <div class="data-row"><span class="data-label">Grain Size:</span> <span class="data-value">${sampleData.grainSize}</span></div>
        //             <div class="data-row"><span class="data-label">Type:</span> <span class="data-value">${sampleData.type}</span></div>
        //             <div class="data-row"><span class="data-label">Avg Grain Size:</span> <span class="data-value">${sampleData.analysis.avgGrainSize}</span></div>
        //             <div class="data-row"><span class="data-label">Roundness:</span> <span class="data-value">${sampleData.analysis.roundness}</span></div>
        //             <div class="data-row"><span class="data-label">Sorting:</span> <span class="data-value">${sampleData.analysis.sortingLevel}</span></div>
        //             <div class="data-row"><span class="data-label">Composition:</span> <span class="data-value">${sampleData.analysis.composition}</span></div>
        //             <div class="data-row"><span class="data-label">Porosity:</span> <span class="data-value">${sampleData.analysis.porosity}</span></div>
        //         </div>
        //     `;
            
        //     analysisGrid.innerHTML = '';
        //     analysisGrid.appendChild(analysisItem);

        //     // Show success message
        //     showModal('‚úÖ Sample Selected', `${sampleData.name} has been loaded for analysis. Detailed grain analysis data is now displayed.`, [
        //         { text: 'OK', action: () => closeModal() }
        //     ]);
        // }

        // Main functions
        function captureImage() {
        // This now shows a simple informational pop-up instead of complex logic
        showModal(
            'Capture image', // Title of the pop-up
            'This feature allows the user to take multiple pictures of the same area within a 10 cm radius. Along with each image, the GPS location is automatically recorded.', // Your desired text
            [
                // Custom button to just close the modal
                { text: 'OK', action: () => closeModal() } 
            ]
        );
        }

        function uploadImage() {
        // This now shows a simple informational pop-up instead of opening the file dialog
        showModal(
            'Images ready for analysis', // Title of the pop-up
            'This feature allows the user to upload the captured images. After uploading, the images are plotted on a map based on their GPS coordinates and are ready for analysis', // Your desired text
            [
                // Custom button to just close the modal
                { text: 'ok', action: () => closeModal() } 
            ]
            );
        }

        function openGallery() {
        // This function now only displays a custom pop-up message.
        showModal(
            'üé® Gallery Feature Status', // Title of the pop-up
            'The full gallery feature is under development. You can see a preview of recently analyzed sample images on the main page, or select a sample under the "Validation & Analysis" section.', // Your desired text
            [
            // Custom button to just close the modal
            { text: 'Close', action: () => closeModal() } 
         ]
        );}

        // function simulateCapture() {
        //     const sampleImage = generateSampleImageSVG('Sand Sample', '#d4c4a8');
        //     const imageData = {
        //         id: Date.now(),
        //         src: sampleImage,
        //         name: `Sample_${Date.now()}.jpg`,
        //         timestamp: new Date().toISOString(),
        //         location: { lat: 18.52 + Math.random() * 0.01, lng: 73.85 + Math.random() * 0.01 }
        //     };
            
        //     capturedImages.push(imageData);
        //     localStorage.setItem('capturedImages', JSON.stringify(capturedImages));
            
        //     closeModal();
        //     updateGallery();
        //     updateStats();
        //     showModal('‚úÖ Image Captured', 'Sand grain sample captured successfully!');
        // }

        // ** ORIGINAL FUNCTION (NO LONGER USED BY BUTTON) **
        // function analyzeAllImages() {
        //     if (capturedImages.length === 0) {
        //         showModal('‚ÑπÔ∏è No Images', 'No images to analyze. Capture some images first!');
        //         return;
        //     }
        //     showModal('üî¨ Analyzing', 'Running AI analysis on all captured images...');
            
        //     setTimeout(() => {
        //         // Generate analysis results for all images
        //         capturedImages.forEach(image => {
        //             if (!analysisResults.find(result => result.imageId === image.id)) {
        //                 const analysis = generateAnalysisResult(image);
        //                 analysisResults.push(analysis);
        //             }
        //         });
                
        //         localStorage.setItem('analysisResults', JSON.stringify(analysisResults));
        //         closeModal();
        //         updateStats();
        //         updateAnalysisDisplay();
        //         showModal('‚úÖ Analysis Complete', 'All images have been analyzed successfully!');
        //     }, 2000);
        // }

        // ** NEW FUNCTION: Shows a pop-up with custom text only **
        function showAnalysisInfo() {
            showModal(
                'üî¨ Analysis Information', 
                'Uploaded samples with location data are processed to analyze sand grain size distribution and classifies the region according to its morphodynamics.The results of the analysis are displayed below for your review.',
                [
                    { text: 'Got It!', action: () => closeModal() }
                ]
            );
        }
        
        // function generateAnalysisResult(image) {
        //     const grainSizes = ['Fine (0.1-0.25mm)', 'Medium (0.25-0.5mm)', 'Coarse (0.5-1mm)', 'Very Coarse (1-2mm)'];
        //     const sortingTypes = ['Well sorted', 'Moderately sorted', 'Poorly sorted'];
        //     const roundnessTypes = ['Angular', 'Sub-angular', 'Sub-rounded', 'Rounded'];
            
        //     return {
        //         imageId: image.id,
        //         imageName: image.name,
        //         imageSrc: image.src,
        //         location: image.location,
        //         timestamp: new Date().toISOString(),
        //         grainSize: grainSizes[Math.floor(Math.random() * grainSizes.length)],
        //         sorting: sortingTypes[Math.floor(Math.random() * sortingTypes.length)],
        //         roundness: roundnessTypes[Math.floor(Math.random() * roundnessTypes.length)],
        //         averageSize: (Math.random() * 2).toFixed(2) + 'mm',
        //         grainCount: Math.floor(Math.random() * 500) + 100,
        //         dominantMinerals: ['Quartz', 'Feldspar', 'Mica'][Math.floor(Math.random() * 3)]
        //     };
        // }

        function updateAnalysisDisplay() {
            const analysisGrid = document.getElementById('analysisGrid');
            
            if (analysisResults.length === 0) {
                analysisGrid.innerHTML = `
                    <div class="analysis-placeholder">
                        <div style="font-size: 3rem; margin-bottom: 1rem;">üî¨</div>
                        <h3>No Analysis Data Yet</h3>
                        <p>Capture or upload images and run analysis to see detailed results here</p>
                    </div>
                `;
                return;
            }

            analysisGrid.innerHTML = analysisResults.map(result => `
                <div class="analysis-item">
                    <div class="analysis-image">
                        <img src="${result.imageSrc}" alt="${result.imageName}">
                    </div>
                    <div class="analysis-data">
                        <h4>${result.imageName}</h4>
                        <div class="data-row">
                            <span class="data-label">Location:</span>
                            <span class="data-value">${result.location.lat.toFixed(4)}, ${result.location.lng.toFixed(4)}</span>
                        </div>
                        <div class="data-row">
                            <span class="data-label">Grain Size:</span>
                            <span class="data-value">${result.grainSize}</span>
                        </div>
                        <div class="data-row">
                            <span class="data-label">Average Size:</span>
                            <span class="data-value">${result.averageSize}</span>
                        </div>
                        <div class="data-row">
                            <span class="data-label">Sorting:</span>
                            <span class="data-value">${result.sorting}</span>
                        </div>
                        <div class="data-row">
                            <span class="data-label">Roundness:</span>
                            <span class="data-value">${result.roundness}</span>
                        </div>
                        <div class="data-row">
                            <span class="data-label">Grain Count:</span>
                            <span class="data-value">${result.grainCount}</span>
                        </div>
                        <div class="data-row">
                            <span class="data-label">Dominant Mineral:</span>
                            <span class="data-value">${result.dominantMinerals}</span>
                        </div>
                    </div>
                </div>
            `).join('');
        }

        // function clearAllData() {
        //     if (confirm('Are you sure you want to clear all data? This action cannot be undone.')) {
        //         capturedImages = [];
        //         analysisResults = [];
        //         localStorage.removeItem('capturedImages');
        //         localStorage.removeItem('analysisResults');
                
        //         updateStats();
        //         updateGallery();
        //         updateAnalysisDisplay();
                
        //         showModal('‚úÖ Data Cleared', 'All data has been cleared successfully.');
        //     }
        // }

        // function exportData() {
        //     showModal('üìä Exporting Data', 'Preparing data export...');
        //     setTimeout(() => {
        //         closeModal();
        //         showModal('‚úÖ Export Complete', 'Data exported successfully!');
        //     }, 1500);
        // }

        // function generateSampleImageSVG(text, color) {
        //     const svg = `
        //         <svg width="200" height="200" xmlns="http://www.w3.org/2000/svg">
        //             <rect width="200" height="200" fill="${color}"/>
        //             <circle cx="50" cy="50" r="5" fill="#999" opacity="0.7"/>
        //             <circle cx="120" cy="80" r="3" fill="#777" opacity="0.8"/>
        //             <circle cx="170" cy="60" r="4" fill="#666" opacity="0.6"/>
        //             <text x="100" y="110" font-family="Arial" font-size="14" fill="#333" text-anchor="middle">${text}</text>
        //         </svg>
        //     `;
        //     return 'data:image/svg+xml;base64,' + btoa(svg);
        // }

        // function updateGallery() {
        //     const gallery = document.getElementById('imageGallery');
        //     if (capturedImages.length > 0) {
        //         gallery.innerHTML = capturedImages.slice(0, 6).map(img => `
        //             <div class="gallery-item">
        //                 <img src="${img.src}" style="width: 100%; height: 100px; object-fit: cover; border-radius: 5px;">
        //                 <p style="margin-top: 0.5rem; font-size: 0.9rem;">${img.name}</p>
        //             </div>
        //         `).join('');
        //     }
        // }

        // function updateStats() {
            // NOTE: The IDs below (`totalImages`, `analyzedCount`, `avgGrainSize`, `coverageArea`) 
            // are not present in the HTML, so this function is largely ineffective 
            // but is kept for script integrity.
            // if (document.getElementById('totalImages')) {
            //     document.getElementById('totalImages').textContent = capturedImages.length;
            //     document.getElementById('analyzedCount').textContent = Math.floor(capturedImages.length * 0.8);
            //     document.getElementById('avgGrainSize').textContent = (Math.random() * 2).toFixed(2) + 'mm';
            //     document.getElementById('coverageArea').textContent = (capturedImages.length * 0.05).toFixed(2);
            // }
        // }

        // Modal functions
        function showModal(title, message, actions = []) {
            const modal = document.getElementById('actionModal');
            const modalTitle = document.getElementById('modalTitle');
            const modalText = document.getElementById('modalText');
            const modalActions = document.getElementById('modalActions');
            
            modalTitle.textContent = title;
            modalText.textContent = message;
            
            modalActions.innerHTML = '';
            // If custom actions are provided, use them
            if (actions.length > 0) {
                actions.forEach(action => {
                    const button = document.createElement('button');
                    button.className = 'btn btn-primary';
                    button.textContent = action.text;
                    button.onclick = action.action; // Attach the custom function
                    button.style.margin = '0.5rem';
                    modalActions.appendChild(button);
                });
            } else {
                // Otherwise, provide a default close button
                const closeButton = document.createElement('button');
                closeButton.className = 'btn btn-primary';
                closeButton.textContent = 'Close';
                closeButton.onclick = closeModal;
                closeButton.style.margin = '0.5rem';
                modalActions.appendChild(closeButton);
            }
            
            modal.style.display = 'block';
        }

        function closeModal() {
            document.getElementById('actionModal').style.display = 'none';
        }

        // Close modal when clicking outside
        window.onclick = function(event) {
            const modal = document.getElementById('actionModal');
            if (event.target === modal) {
                closeModal();
            }
        }

        // Smooth scrolling for navigation
        document.querySelectorAll('a[href^="#"]').forEach(anchor => {
            anchor.addEventListener('click', function (e) {
                e.preventDefault();
                document.querySelector(this.getAttribute('href')).scrollIntoView({
                    behavior: 'smooth'
                });
            });
        });

        // Initialize
        document.addEventListener('DOMContentLoaded', function() {
            // updateStats();
            // updateGallery();
            updateAnalysisDisplay();
        });
    </script>
</body>
</html>